{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "f02e749a-3b39-4396-9e59-e37e4744cddc",
   "metadata": {},
   "outputs": [],
   "source": [
    "import random\n",
    "from collections import Counter\n",
    "\n",
    "# -------------------------------\n",
    "# CONFIGURATION\n",
    "# -------------------------------\n",
    "STARTING_BALANCE = 100        # Default starting credits\n",
    "MIN_BET = 1\n",
    "MAX_BET = 100\n",
    "\n",
    "# Symbol frequencies (weights) approximate \"rarity\" on each reel.\n",
    "# Higher numbers = more common; lower numbers = rarer.\n",
    "SYMBOL_WEIGHTS = {\n",
    "    \"7\": 2,        # rarest\n",
    "    \"BAR\": 4,\n",
    "    \"üîî\": 6,\n",
    "    \"‚≠ê\": 8,\n",
    "    \"üçã\": 10,\n",
    "    \"üçí\": 12       # most common\n",
    "}\n",
    "\n",
    "# Payouts for 3-of-a-kind on the CENTER payline (multiplier of bet)\n",
    "PAYOUTS_3OAK = {\n",
    "    \"7\": 50,\n",
    "    \"BAR\": 20,\n",
    "    \"üîî\": 10,\n",
    "    \"‚≠ê\": 8,\n",
    "    \"üçã\": 5,\n",
    "    \"üçí\": 3\n",
    "}\n",
    "\n",
    "# Small consolation payout for two cherries on the payline\n",
    "TWO_CHERRIES_PAYOUT = 1  # returns 1x bet if exactly two üçí on the line\n",
    "\n",
    "# -------------------------------\n",
    "# PROBABILITY / MATH HELPERS\n",
    "# -------------------------------\n",
    "def compute_probabilities(symbol_weights):\n",
    "    \"\"\"\n",
    "    Compute:\n",
    "      - probability of each symbol on a single reel\n",
    "      - probability of 3-of-a-kind for each symbol\n",
    "      - probability of exactly two cherries on the payline\n",
    "      - expected return (EV) per 1-credit spin\n",
    "    using the current SYMBOL_WEIGHTS and PAYOUTS_3OAK.\n",
    "    \"\"\"\n",
    "    total_weight = sum(symbol_weights.values())\n",
    "\n",
    "    # Probability of each symbol on a single reel\n",
    "    symbol_probs = {\n",
    "        sym: weight / total_weight\n",
    "        for sym, weight in symbol_weights.items()\n",
    "    }\n",
    "\n",
    "    # 3-of-a-kind probabilities for each symbol (3 independent reels)\n",
    "    threeoak_probs = {\n",
    "        sym: p ** 3\n",
    "        for sym, p in symbol_probs.items()\n",
    "    }\n",
    "\n",
    "    # Probability of exactly two cherries on the line:\n",
    "    # Choose which 2 positions have cherries: C(3, 2) = 3\n",
    "    # P = 3 * p_cherry^2 * (1 - p_cherry)\n",
    "    p_cherry = symbol_probs[\"üçí\"]\n",
    "    p_two_cherries = 3 * (p_cherry ** 2) * (1 - p_cherry)\n",
    "\n",
    "    # Expected value (EV) per 1-credit spin:\n",
    "    # Sum over all 3-of-a-kind wins + the two-cherries consolation\n",
    "    ev_3oak = 0.0\n",
    "    for sym, p3 in threeoak_probs.items():\n",
    "        payout_multiplier = PAYOUTS_3OAK[sym]\n",
    "        ev_3oak += p3 * payout_multiplier  # since bet = 1 credit\n",
    "\n",
    "    ev_two_cherries = p_two_cherries * TWO_CHERRIES_PAYOUT\n",
    "\n",
    "    expected_return_per_credit = ev_3oak + ev_two_cherries\n",
    "\n",
    "    return symbol_probs, threeoak_probs, p_two_cherries, expected_return_per_credit\n",
    "\n",
    "# -------------------------------\n",
    "# CORE MECHANICS\n",
    "# -------------------------------\n",
    "def build_reel(symbol_weights):\n",
    "    \"Return a list representing a single reel strip built from weights.\"\n",
    "    reel = []\n",
    "    for sym, w in symbol_weights.items():\n",
    "        reel.extend([sym] * int(w))\n",
    "    return reel\n",
    "\n",
    "def spin_reels(rng, reels):\n",
    "    \"Spin three reels and return the symbols on the single center payline.\"\n",
    "    return tuple(rng.choice(reel) for reel in reels)\n",
    "\n",
    "def evaluate_payline(line, bet):\n",
    "    \"Return (payout, message). payout is the CREDIT amount (not multiplier).\"\n",
    "    c = Counter(line)\n",
    "    # 3-of-a-kind\n",
    "    for sym in PAYOUTS_3OAK:\n",
    "        if c[sym] == 3:\n",
    "            win = PAYOUTS_3OAK[sym] * bet\n",
    "            return win, f\"3-of-a-kind {sym}! You win {win} credits.\"\n",
    "    # Two cherries consolation\n",
    "    if c[\"üçí\"] == 2:\n",
    "        win = TWO_CHERRIES_PAYOUT * bet\n",
    "        return win, f\"Two üçí! You win {win} credits.\"\n",
    "    # No win\n",
    "    return 0, \"No win. Better luck next spin!\"\n",
    "\n",
    "def prompt_bet(balance):\n",
    "    while True:\n",
    "        raw = input(f\"Enter your bet ({MIN_BET}-{MAX_BET}) or 'q' to cash out: \").strip().lower()\n",
    "        if raw == 'q':\n",
    "            return None\n",
    "        if not raw.isdigit():\n",
    "            print(\"Please enter a whole number or 'q'.\")\n",
    "            continue\n",
    "        amt = int(raw)\n",
    "        if amt < MIN_BET or amt > MAX_BET:\n",
    "            print(f\"Bet must be between {MIN_BET} and {MAX_BET}.\")\n",
    "            continue\n",
    "        if amt > balance:\n",
    "            print(\"You cannot bet more than your current balance.\")\n",
    "            continue\n",
    "        return amt\n",
    "\n",
    "# Main interface User sees\n",
    "def main():\n",
    "    print(\"üé∞ Welcome to the Gamble3000! (Go All In Or You Are A Softie)\")\n",
    "    print(\"Symbols: 7, BAR, üîî, ‚≠ê, üçã, üçí\")\n",
    "    print(f\"Payouts (3-of-a-kind, x bet): {PAYOUTS_3OAK}\")\n",
    "    print(f\"Consolation: exactly two üçí pays {TWO_CHERRIES_PAYOUT}x bet\")\n",
    "    print()\n",
    "\n",
    "    # ---- NEW: compute and display probabilities / expected value ----\n",
    "    symbol_probs, threeoak_probs, p_two_cherries, expected_return = compute_probabilities(SYMBOL_WEIGHTS)\n",
    "\n",
    "    print(\"===== Theoretical Chances on a Single Spin (Center Payline) =====\")\n",
    "    for sym in SYMBOL_WEIGHTS:\n",
    "        p_sym = symbol_probs[sym]\n",
    "        p_3 = threeoak_probs[sym]\n",
    "        print(\n",
    "            f\"{sym}:\"\n",
    "            f\" appears on any one reel ‚âà {p_sym * 100:.2f}% of the time,\"\n",
    "            f\" 3-of-a-kind ‚âà {p_3 * 100:.4f}% per spin.\"\n",
    "        )\n",
    "    print(f\"Exactly two üçí on the line: ‚âà {p_two_cherries * 100:.4f}% per spin.\")\n",
    "    print()\n",
    "\n",
    "    print(\"===== Expected Value (EV) =====\")\n",
    "    print(f\"Expected return per 1-credit spin: {expected_return:.3f} credits\")\n",
    "    print(f\"House edge (average loss) per spin: {(1 - expected_return) * 100:.2f}%\")\n",
    "    print(\"=================================================================\\n\")\n",
    "\n",
    "    rng = random.Random()  # independent RNG for testability (can set seed if desired)\n",
    "    reels = [build_reel(SYMBOL_WEIGHTS) for _ in range(3)]\n",
    "    balance = STARTING_BALANCE\n",
    "\n",
    "    print(f\"Starting balance: {balance} credits.\")\n",
    "    while True:\n",
    "        bet = prompt_bet(balance)\n",
    "        if bet is None:\n",
    "            print(f\"Cashing out with {balance} credits. Thanks for playing!\")\n",
    "            break\n",
    "\n",
    "        balance -= bet\n",
    "        line = spin_reels(rng, reels)\n",
    "        print(f\"Spin: {' | '.join(line)}\")\n",
    "        win, msg = evaluate_payline(line, bet)\n",
    "        print(msg)\n",
    "        balance += win\n",
    "        print(f\"Balance: {balance} credits\\n\")\n",
    "        # Running out of credits = Game Over\n",
    "        if balance < MIN_BET:\n",
    "            print(\"You are below the minimum bet. Ur Washed.\")\n",
    "            print(f\"Final cashout: {balance} credits.\")\n",
    "            break\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    main()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
